<html>
<head>
    <title>VkGraph</title>
    <meta charset="utf-8">

    <link href="../static/css/bootstrap.min.css" rel="stylesheet">

    <link href="../static/css/bootstrap-material-design/bootstrap-material-design.min.css" rel="stylesheet">
    <link href="../static/css/bootstrap-material-design/ripples.min.css" rel="stylesheet">

    <link href="../static/css/main.css" rel="stylesheet">
</head>
<body>
<div class="container-fluid container-table">
    <div class="row vertical-center-row" id="input-row">
        <div class="col-md-4 col-md-offset-4">
            <div class="card flipInX animated">
                <div class="form-group label-floating">
                    <label class="control-label" for="userId">Введите id пользователя Вконтакте</label>
                    <input class="form-control" id="userId" type="text">
                    <a class="btn btn-default center-block" id="scan">Сканировать</a>
                </div>
            </div>
        </div>
    </div>
    <div class="graph-container"></div>
</div>
<script src="../static/js/jquery-1.10.2.min.js"></script>
<script src="../static/js/bootstrap.min.js"></script>
<script src="../static/js/bootstrap-material-design/ripples.min.js"></script>
<script src="../static/js/bootstrap-material-design/material.min.js"></script>
<script src="../static/js/d3plus.full.min.js"></script>
<script>
    $(function () {
        $.material.init();

        $("#scan").click(function () {
            $("#input-row").hide();
            $.ajax({
                url: "mutual_friends",
                data: {user_id: $("#userId").val()},
                success: function (response) {
                    var graph = d3plus.viz()
                        .format("ru_RU")
                        .container(".graph-container")
                        .resize(true)
                        .type("network")
                        .data(response.nodes)
                        .edges(response.edges)
                        .id("id")
                        .text("label")
                        .icon("image")
                        .draw();
                    graph.width($(".graph-container").width()).draw();
                },
                error: function () {
                    $("#input-row").show();
                    alert("Нет такого пользователя")
                }
            })
        })
    })
</script>
</body>
</html>